using Decimals
using Test

@testset "Round" begin
    @testset "RoundToZero" begin
        @test round(dec"1928.37465", RoundToZero, digits=-5) == dec"0.0"
        @test round(dec"1928.37465", RoundToZero, digits=-4) == dec"0.0"
        @test round(dec"1928.37465", RoundToZero, digits=-3) == dec"1000.0"
        @test round(dec"1928.37465", RoundToZero, digits=-2) == dec"1900.0"
        @test round(dec"1928.37465", RoundToZero, digits=-1) == dec"1920.0"
        @test round(dec"1928.37465", RoundToZero, digits=0) == dec"1928.0"
        @test round(dec"1928.37465", RoundToZero, digits=1) == dec"1928.3"
        @test round(dec"1928.37465", RoundToZero, digits=2) == dec"1928.37"
        @test round(dec"1928.37465", RoundToZero, digits=3) == dec"1928.374"
        @test round(dec"1928.37465", RoundToZero, digits=4) == dec"1928.3746"
        @test round(dec"1928.37465", RoundToZero, digits=5) == dec"1928.37465"
        @test round(dec"1928.37465", RoundToZero, digits=6) == dec"1928.37465"

        @test round(dec"1928.37465", RoundToZero, sigdigits=-1) == dec"0"
        @test round(dec"1928.37465", RoundToZero, sigdigits=0) == dec"0"
        @test round(dec"1928.37465", RoundToZero, sigdigits=1) == dec"1000"
        @test round(dec"1928.37465", RoundToZero, sigdigits=2) == dec"1900"
        @test round(dec"1928.37465", RoundToZero, sigdigits=3) == dec"1920"
        @test round(dec"1928.37465", RoundToZero, sigdigits=4) == dec"1928."
        @test round(dec"1928.37465", RoundToZero, sigdigits=5) == dec"1928.3"
        @test round(dec"1928.37465", RoundToZero, sigdigits=6) == dec"1928.37"
        @test round(dec"1928.37465", RoundToZero, sigdigits=7) == dec"1928.374"
        @test round(dec"1928.37465", RoundToZero, sigdigits=8) == dec"1928.3746"
        @test round(dec"1928.37465", RoundToZero, sigdigits=9) == dec"1928.37465"
        @test round(dec"1928.37465", RoundToZero, sigdigits=10) == dec"1928.37465"
    end

    @testset "RoundNearestTiesAway" begin
        @test round(dec"1928.37465", RoundNearestTiesAway, digits=-5) == dec"0.0"
        @test round(dec"1928.37465", RoundNearestTiesAway, digits=-4) == dec"0.0"
        @test round(dec"1928.37465", RoundNearestTiesAway, digits=-3) == dec"2000.0"
        @test round(dec"1928.37465", RoundNearestTiesAway, digits=-2) == dec"1900.0"
        @test round(dec"1928.37465", RoundNearestTiesAway, digits=-1) == dec"1930.0"
        @test round(dec"1928.37465", RoundNearestTiesAway, digits=0) == dec"1928.0"
        @test round(dec"1928.37465", RoundNearestTiesAway, digits=1) == dec"1928.4"
        @test round(dec"1928.37465", RoundNearestTiesAway, digits=2) == dec"1928.37"
        @test round(dec"1928.37465", RoundNearestTiesAway, digits=3) == dec"1928.375"
        @test round(dec"1928.37465", RoundNearestTiesAway, digits=4) == dec"1928.3747"
        @test round(dec"1928.37465", RoundNearestTiesAway, digits=5) == dec"1928.37465"
        @test round(dec"1928.37465", RoundNearestTiesAway, digits=6) == dec"1928.37465"

        @test round(dec"1928.37465", RoundNearestTiesAway, sigdigits=-1) == dec"0"
        @test round(dec"1928.37465", RoundNearestTiesAway, sigdigits=0) == dec"0"
        @test round(dec"1928.37465", RoundNearestTiesAway, sigdigits=1) == dec"2000"
        @test round(dec"1928.37465", RoundNearestTiesAway, sigdigits=2) == dec"1900"
        @test round(dec"1928.37465", RoundNearestTiesAway, sigdigits=3) == dec"1930"
        @test round(dec"1928.37465", RoundNearestTiesAway, sigdigits=4) == dec"1928."
        @test round(dec"1928.37465", RoundNearestTiesAway, sigdigits=5) == dec"1928.4"
        @test round(dec"1928.37465", RoundNearestTiesAway, sigdigits=6) == dec"1928.37"
        @test round(dec"1928.37465", RoundNearestTiesAway, sigdigits=7) == dec"1928.375"
        @test round(dec"1928.37465", RoundNearestTiesAway, sigdigits=8) == dec"1928.3747"
        @test round(dec"1928.37465", RoundNearestTiesAway, sigdigits=9) == dec"1928.37465"
        @test round(dec"1928.37465", RoundNearestTiesAway, sigdigits=10) == dec"1928.37465"
    end

    @testset "RoundNearest" begin
        @test round(dec"1928.37465", RoundNearest, digits=-5) == dec"0.0"
        @test round(dec"1928.37465", RoundNearest, digits=-4) == dec"0.0"
        @test round(dec"1928.37465", RoundNearest, digits=-3) == dec"2000.0"
        @test round(dec"1928.37465", RoundNearest, digits=-2) == dec"1900.0"
        @test round(dec"1928.37465", RoundNearest, digits=-1) == dec"1930.0"
        @test round(dec"1928.37465", RoundNearest, digits=0) == dec"1928.0"
        @test round(dec"1928.37465", RoundNearest, digits=1) == dec"1928.4"
        @test round(dec"1928.37465", RoundNearest, digits=2) == dec"1928.37"
        @test round(dec"1928.37465", RoundNearest, digits=3) == dec"1928.375"
        @test round(dec"1928.37465", RoundNearest, digits=4) == dec"1928.3746"
        @test round(dec"1928.37465", RoundNearest, digits=5) == dec"1928.37465"
        @test round(dec"1928.37465", RoundNearest, digits=6) == dec"1928.37465"

        @test round(dec"1928.37465", RoundNearest, sigdigits=-1) == dec"0"
        @test round(dec"1928.37465", RoundNearest, sigdigits=0) == dec"0"
        @test round(dec"1928.37465", RoundNearest, sigdigits=1) == dec"2000"
        @test round(dec"1928.37465", RoundNearest, sigdigits=2) == dec"1900"
        @test round(dec"1928.37465", RoundNearest, sigdigits=3) == dec"1930"
        @test round(dec"1928.37465", RoundNearest, sigdigits=4) == dec"1928."
        @test round(dec"1928.37465", RoundNearest, sigdigits=5) == dec"1928.4"
        @test round(dec"1928.37465", RoundNearest, sigdigits=6) == dec"1928.37"
        @test round(dec"1928.37465", RoundNearest, sigdigits=7) == dec"1928.375"
        @test round(dec"1928.37465", RoundNearest, sigdigits=8) == dec"1928.3746"
        @test round(dec"1928.37465", RoundNearest, sigdigits=9) == dec"1928.37465"
        @test round(dec"1928.37465", RoundNearest, sigdigits=10) == dec"1928.37465"
    end

    @testset "RoundUp" begin
        @test round(dec"1928.37465", RoundUp, digits=-5) == dec"100000.0"
        @test round(dec"1928.37465", RoundUp, digits=-4) == dec"10000.0"
        @test round(dec"1928.37465", RoundUp, digits=-3) == dec"2000.0"
        @test round(dec"1928.37465", RoundUp, digits=-2) == dec"2000.0"
        @test round(dec"1928.37465", RoundUp, digits=-1) == dec"1930.0"
        @test round(dec"1928.37465", RoundUp, digits=0) == dec"1929.0"
        @test round(dec"1928.37465", RoundUp, digits=1) == dec"1928.4"
        @test round(dec"1928.37465", RoundUp, digits=2) == dec"1928.38"
        @test round(dec"1928.37465", RoundUp, digits=3) == dec"1928.375"
        @test round(dec"1928.37465", RoundUp, digits=4) == dec"1928.3747"
        @test round(dec"1928.37465", RoundUp, digits=5) == dec"1928.37465"
        @test round(dec"1928.37465", RoundUp, digits=6) == dec"1928.37465"

        @test round(dec"1928.37465", RoundUp, sigdigits=-1) == dec"100000"
        @test round(dec"1928.37465", RoundUp, sigdigits=0) == dec"10000"
        @test round(dec"1928.37465", RoundUp, sigdigits=1) == dec"2000"
        @test round(dec"1928.37465", RoundUp, sigdigits=2) == dec"2000"
        @test round(dec"1928.37465", RoundUp, sigdigits=3) == dec"1930"
        @test round(dec"1928.37465", RoundUp, sigdigits=4) == dec"1929."
        @test round(dec"1928.37465", RoundUp, sigdigits=5) == dec"1928.4"
        @test round(dec"1928.37465", RoundUp, sigdigits=6) == dec"1928.38"
        @test round(dec"1928.37465", RoundUp, sigdigits=7) == dec"1928.375"
        @test round(dec"1928.37465", RoundUp, sigdigits=8) == dec"1928.3747"
        @test round(dec"1928.37465", RoundUp, sigdigits=9) == dec"1928.37465"
        @test round(dec"1928.37465", RoundUp, sigdigits=10) == dec"1928.37465"
    end

    @testset "RoundDown" begin
        @test round(dec"1928.37465", RoundDown, digits=-5) == dec"0.0"
        @test round(dec"1928.37465", RoundDown, digits=-4) == dec"0.0"
        @test round(dec"1928.37465", RoundDown, digits=-3) == dec"1000.0"
        @test round(dec"1928.37465", RoundDown, digits=-2) == dec"1900.0"
        @test round(dec"1928.37465", RoundDown, digits=-1) == dec"1920.0"
        @test round(dec"1928.37465", RoundDown, digits=0) == dec"1928.0"
        @test round(dec"1928.37465", RoundDown, digits=1) == dec"1928.3"
        @test round(dec"1928.37465", RoundDown, digits=2) == dec"1928.37"
        @test round(dec"1928.37465", RoundDown, digits=3) == dec"1928.374"
        @test round(dec"1928.37465", RoundDown, digits=4) == dec"1928.3746"
        @test round(dec"1928.37465", RoundDown, digits=5) == dec"1928.37465"
        @test round(dec"1928.37465", RoundDown, digits=6) == dec"1928.37465"

        @test round(dec"1928.37465", RoundDown, sigdigits=-1) == dec"0"
        @test round(dec"1928.37465", RoundDown, sigdigits=0) == dec"0"
        @test round(dec"1928.37465", RoundDown, sigdigits=1) == dec"1000"
        @test round(dec"1928.37465", RoundDown, sigdigits=2) == dec"1900"
        @test round(dec"1928.37465", RoundDown, sigdigits=3) == dec"1920"
        @test round(dec"1928.37465", RoundDown, sigdigits=4) == dec"1928."
        @test round(dec"1928.37465", RoundDown, sigdigits=5) == dec"1928.3"
        @test round(dec"1928.37465", RoundDown, sigdigits=6) == dec"1928.37"
        @test round(dec"1928.37465", RoundDown, sigdigits=7) == dec"1928.374"
        @test round(dec"1928.37465", RoundDown, sigdigits=8) == dec"1928.3746"
        @test round(dec"1928.37465", RoundDown, sigdigits=9) == dec"1928.37465"
        @test round(dec"1928.37465", RoundDown, sigdigits=10) == dec"1928.37465"
    end

    @testset "RoundFromZero" begin
        @test round(dec"1928.37465", RoundFromZero, digits=-5) == dec"100000.0"
        @test round(dec"1928.37465", RoundFromZero, digits=-4) == dec"10000.0"
        @test round(dec"1928.37465", RoundFromZero, digits=-3) == dec"2000.0"
        @test round(dec"1928.37465", RoundFromZero, digits=-2) == dec"2000.0"
        @test round(dec"1928.37465", RoundFromZero, digits=-1) == dec"1930.0"
        @test round(dec"1928.37465", RoundFromZero, digits=0) == dec"1929.0"
        @test round(dec"1928.37465", RoundFromZero, digits=1) == dec"1928.4"
        @test round(dec"1928.37465", RoundFromZero, digits=2) == dec"1928.38"
        @test round(dec"1928.37465", RoundFromZero, digits=3) == dec"1928.375"
        @test round(dec"1928.37465", RoundFromZero, digits=4) == dec"1928.3747"
        @test round(dec"1928.37465", RoundFromZero, digits=5) == dec"1928.37465"
        @test round(dec"1928.37465", RoundFromZero, digits=6) == dec"1928.37465"

        @test round(dec"1928.37465", RoundFromZero, sigdigits=-1) == dec"100000"
        @test round(dec"1928.37465", RoundFromZero, sigdigits=0) == dec"10000"
        @test round(dec"1928.37465", RoundFromZero, sigdigits=1) == dec"2000"
        @test round(dec"1928.37465", RoundFromZero, sigdigits=2) == dec"2000"
        @test round(dec"1928.37465", RoundFromZero, sigdigits=3) == dec"1930"
        @test round(dec"1928.37465", RoundFromZero, sigdigits=4) == dec"1929."
        @test round(dec"1928.37465", RoundFromZero, sigdigits=5) == dec"1928.4"
        @test round(dec"1928.37465", RoundFromZero, sigdigits=6) == dec"1928.38"
        @test round(dec"1928.37465", RoundFromZero, sigdigits=7) == dec"1928.375"
        @test round(dec"1928.37465", RoundFromZero, sigdigits=8) == dec"1928.3747"
        @test round(dec"1928.37465", RoundFromZero, sigdigits=9) == dec"1928.37465"
        @test round(dec"1928.37465", RoundFromZero, sigdigits=10) == dec"1928.37465"
    end

    @testset "Round to Int" begin
        @test round(Int, dec"1928.37465", RoundToZero) == dec"1928"
        @test round(Int, dec"1928.37465", RoundNearestTiesAway) == dec"1928"
        @test round(Int, dec"1928.37465", RoundNearest) == dec"1928"
        @test round(Int, dec"1928.37465", RoundUp) == dec"1929"
        @test round(Int, dec"1928.37465", RoundDown) == dec"1928"
        @test round(Int, dec"1928.37465", RoundFromZero) == dec"1929"
    end

    @test_throws ArgumentError round(dec"123.456", digits=3, sigdigits=5)
end
